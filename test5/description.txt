Compared to test3: Do the map value lookup only once but still do boundary checks every time